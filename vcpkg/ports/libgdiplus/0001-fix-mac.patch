diff --git a/src/text-pango.c b/src/text-pango.c
index 74c921d..fe90a13 100644
--- a/src/text-pango.c
+++ b/src/text-pango.c
@@ -35,6 +35,25 @@
  * NOTE: all parameter's validations are done inside text.c
  */
 
+int
+utf8_length_for_ucs2_string (GDIPCONST WCHAR *stringUnicode, int offset, int length)
+{
+	int utf8_length = 0;
+	int end = offset + length;
+	int i;
+	for (i = offset; i < end; ++i) {
+		unsigned short ch = (unsigned short)stringUnicode[i];
+		if (ch < 0x80)
+			utf8_length += 1;
+		else if (ch < 0x800)
+			utf8_length += 2;
+		else if (ch < 0xD800 || ch >= 0xE000)
+			utf8_length += 3;
+		/* ignore surrogate pairs as they are ignored in ucs2_to_utf8() */
+	}
+	return utf8_length;
+}
+
 static PangoAttrList*
 gdip_get_layout_attributes (PangoLayout *layout)
 {
@@ -703,23 +722,4 @@ cleanup:
 	return status;
 }
 
-int
-utf8_length_for_ucs2_string (GDIPCONST WCHAR *stringUnicode, int offset, int length)
-{
-	int utf8_length = 0;
-	int end = offset + length;
-	int i;
-	for (i = offset; i < end; ++i) {
-		unsigned short ch = (unsigned short)stringUnicode[i];
-		if (ch < 0x80)
-			utf8_length += 1;
-		else if (ch < 0x800)
-			utf8_length += 2;
-		else if (ch < 0xD800 || ch >= 0xE000)
-			utf8_length += 3;
-		/* ignore surrogate pairs as they are ignored in ucs2_to_utf8() */
-	}
-	return utf8_length;
-}
-
 #endif
